<div class="container">
  <h1>All songs</h1>

  <p><a href="/songs/new">Add a new song</a></p>

  <table class="table">
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>User</th>
      <th>URL</th>
      <th>Votes</th>
      <th>Upvote</th>
    </tr>
    <% @songs.sort { |a,b| b.votes.count <=> a.votes.count }.each do |song| %>
      <tr>
        <td><a href="songs/<%= song.id %>"><%= song.title %></a></td>
        <td> <%= song.author%></td>
        <td> <%= song.user.try(:email)%></td>
        <td><% if song.url %> 
                <a href="<%=song.url %>">link</a>
              <% end %>
        <td><%=song.votes.count %></td>
        <td><% if logged_in?
          if
          Vote.where(user_id: current_user.id).where(song_id: song.id).empty? %>
          <a href="/upvote?song=<%= song.id%>"><button>Upvote</button></a>
          <% end %>
        <% else %><button class="btn btn-primary disabled">Must be logged in to upvote</button>
        <% end %></td>
      </tr>
    <% end %>
  </table>

</div>